<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TShark Gen - Modern</title>
    <link rel="stylesheet" href="modern.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="app-wrapper">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="logo-area">
                <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                </svg>
                <span class="logo-text">TShark Gen</span>
            </div>

            <div class="nav-menu">
                <button class="nav-item active" data-tab="input">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                    </svg>
                    输入配置
                </button>
                <button class="nav-item" data-tab="scenarios">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <rect x="3" y="3" width="7" height="7"></rect>
                        <rect x="14" y="3" width="7" height="7"></rect>
                        <rect x="14" y="14" width="7" height="7"></rect>
                        <rect x="3" y="14" width="7" height="7"></rect>
                    </svg>
                    快捷场景
                </button>
                <button class="nav-item" data-tab="filters">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    过滤器
                </button>
                <button class="nav-item" data-tab="output">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    输出格式
                </button>
                <button class="nav-item" data-tab="stats">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <line x1="18" y1="20" x2="18" y2="10"></line>
                        <line x1="12" y1="20" x2="12" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="14"></line>
                    </svg>
                    统计分析
                </button>
                <button class="nav-item" data-tab="advanced">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path
                            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                        </path>
                    </svg>
                    高级选项
                </button>
                <button class="nav-item" data-tab="knowledge">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                    知识库
                </button>
            </div>

            <div class="nav-footer">
                <button id="aiAssistantBtn" class="ai-trigger">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M12 2a10 10 0 1 0 10 10H12V2z"></path>
                        <path d="M12 2a10 10 0 0 1 10 10h-10V2z"></path>
                        <path d="M12 12l9.5-5.5"></path>
                        <path d="M12 12l-9.5-5.5"></path>
                    </svg>
                    AI 助手
                </button>
                <a href="index.html" class="back-link">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                    返回版本选择
                </a>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="content-area">
            <!-- Tab: Input Source -->
            <section id="tab-input" class="tab-content active">
                <div class="panel-header">
                    <h2>输入源配置</h2>
                    <p>选择数据来源，支持文件读取或实时捕获</p>
                </div>

                <div class="card-box">
                    <div class="form-group">
                        <label>TShark 路径 <span class="hint">(Windows用户必填)</span></label>
                        <input type="text" id="tsharkPath" class="modern-input" placeholder="tshark" value="tshark">
                    </div>
                </div>

                <div class="card-box mt-4">
                    <div class="source-toggle">
                        <label class="toggle-option active">
                            <input type="radio" name="inputSource" value="file" checked>
                            <span class="card-option">
                                <svg class="opt-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                    <polyline points="10 9 9 9 8 9"></polyline>
                                </svg>
                                <span class="opt-title">读取文件</span>
                                <span class="opt-desc">分析现有的 .pcap / .pcapng 文件</span>
                            </span>
                        </label>
                        <label class="toggle-option">
                            <input type="radio" name="inputSource" value="interface">
                            <span class="card-option">
                                <svg class="opt-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="2"></circle>
                                    <path
                                        d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14">
                                    </path>
                                </svg>
                                <span class="opt-title">实时捕获</span>
                                <span class="opt-desc">从网卡接口实时抓取流量</span>
                            </span>
                        </label>
                    </div>

                    <div id="fileInputGroup" class="input-details mt-4">
                        <div class="form-group">
                            <label>文件路径</label>
                            <input type="text" id="inputFile" class="modern-input" placeholder="capture.pcap"
                                value="capture.pcap">
                        </div>
                    </div>

                    <div id="interfaceInputGroup" class="input-details mt-4 hidden">
                        <div class="form-group">
                            <label>网络接口</label>
                            <input type="text" id="inputInterface" class="modern-input" placeholder="eth0">
                        </div>
                        <div class="checkbox-row mt-2">
                            <label class="modern-checkbox">
                                <input type="checkbox" id="promiscuous">
                                <span class="checkmark"></span>
                                禁用混杂模式 (-p)
                            </label>
                            <label class="modern-checkbox">
                                <input type="checkbox" id="monitor">
                                <span class="checkmark"></span>
                                监控模式 (-I)
                            </label>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab: Scenarios -->
            <section id="tab-scenarios" class="tab-content">
                <div class="panel-header">
                    <h2>快捷场景</h2>
                    <p>CTF流量取证常见题型一键分析 (共8大类40+模板)</p>
                </div>

                <!-- 一、基础分析 -->
                <div class="scenario-category">
                    <h3 class="category-title">基础分析</h3>
                    <div class="scenarios-grid">
                        <button class="scenario-card" data-scenario="protocol"><span
                                class="s-title">协议分布</span></button>
                        <button class="scenario-card" data-scenario="ipconv"><span class="s-title">IP通信对</span></button>
                        <button class="scenario-card" data-scenario="tcpconv"><span
                                class="s-title">TCP会话</span></button>
                        <button class="scenario-card" data-scenario="endpoints"><span
                                class="s-title">端点统计</span></button>
                        <button class="scenario-card" data-scenario="timeline"><span class="s-title">时间线</span></button>
                        <button class="scenario-card" data-scenario="expert"><span class="s-title">专家分析</span></button>
                    </div>
                </div>

                <!-- 二、HTTP/Web分析 -->
                <div class="scenario-category">
                    <h3 class="category-title">HTTP/Web分析</h3>
                    <div class="scenarios-grid">
                        <button class="scenario-card" data-scenario="http"><span class="s-title">HTTP请求</span></button>
                        <button class="scenario-card" data-scenario="httpResponse"><span
                                class="s-title">HTTP响应</span></button>
                        <button class="scenario-card" data-scenario="useragent"><span
                                class="s-title">User-Agent</span></button>
                        <button class="scenario-card" data-scenario="cookies"><span
                                class="s-title">Cookies</span></button>
                        <button class="scenario-card" data-scenario="post"><span class="s-title">POST数据</span></button>
                        <button class="scenario-card" data-scenario="httpAuth"><span
                                class="s-title">HTTP认证</span></button>
                        <button class="scenario-card" data-scenario="webUpload"><span
                                class="s-title">文件上传</span></button>
                        <button class="scenario-card" data-scenario="webshell"><span
                                class="s-title">Webshell检测</span></button>
                        <button class="scenario-card" data-scenario="sqli"><span class="s-title">SQL注入</span></button>
                    </div>
                </div>

                <!-- 三、凭据与敏感信息 -->
                <div class="scenario-category">
                    <h3 class="category-title">凭据与敏感信息</h3>
                    <div class="scenarios-grid">
                        <button class="scenario-card" data-scenario="credentials"><span
                                class="s-title">FTP凭据</span></button>
                        <button class="scenario-card" data-scenario="telnet"><span
                                class="s-title">Telnet会话</span></button>
                        <button class="scenario-card" data-scenario="smtp"><span class="s-title">SMTP邮件</span></button>
                        <button class="scenario-card" data-scenario="imapPop"><span
                                class="s-title">IMAP/POP3</span></button>
                        <button class="scenario-card" data-scenario="basicAuth"><span
                                class="s-title">Basic认证</span></button>
                        <button class="scenario-card" data-scenario="flagSearch"><span
                                class="s-title">Flag搜索</span></button>
                    </div>
                </div>

                <!-- 四、DNS分析 -->
                <div class="scenario-category">
                    <h3 class="category-title">DNS分析</h3>
                    <div class="scenarios-grid">
                        <button class="scenario-card" data-scenario="dns"><span class="s-title">DNS查询</span></button>
                        <button class="scenario-card" data-scenario="dnsStats"><span
                                class="s-title">DNS统计</span></button>
                        <button class="scenario-card" data-scenario="dnsTunnel"><span
                                class="s-title">DNS隧道</span></button>
                        <button class="scenario-card" data-scenario="dnsExfil"><span
                                class="s-title">DNS外传</span></button>
                    </div>
                </div>

                <!-- 五、隐写与数据提取 -->
                <div class="scenario-category">
                    <h3 class="category-title">隐写与数据提取</h3>
                    <div class="scenarios-grid">
                        <button class="scenario-card" data-scenario="icmpData"><span
                                class="s-title">ICMP数据</span></button>
                        <button class="scenario-card" data-scenario="tcpPayload"><span
                                class="s-title">TCP载荷</span></button>
                        <button class="scenario-card" data-scenario="base64Data"><span
                                class="s-title">Base64数据</span></button>
                        <button class="scenario-card" data-scenario="hexData"><span class="s-title">十六进制</span></button>
                    </div>
                </div>

                <!-- 六、攻击检测 -->
                <div class="scenario-category">
                    <h3 class="category-title">攻击检测</h3>
                    <div class="scenarios-grid">
                        <button class="scenario-card" data-scenario="portScan"><span
                                class="s-title">端口扫描</span></button>
                        <button class="scenario-card" data-scenario="synFlood"><span
                                class="s-title">SYN洪泛</span></button>
                        <button class="scenario-card" data-scenario="bruteforce"><span
                                class="s-title">暴力破解</span></button>
                        <button class="scenario-card" data-scenario="c2"><span class="s-title">C2通信</span></button>
                        <button class="scenario-card" data-scenario="malwareDns"><span
                                class="s-title">恶意域名</span></button>
                    </div>
                </div>

                <!-- 七、流追踪类 -->
                <div class="scenario-category">
                    <h3 class="category-title">流追踪</h3>
                    <div class="scenarios-grid">
                        <button class="scenario-card" data-scenario="tcpstream"><span
                                class="s-title">TCP流0</span></button>
                        <button class="scenario-card" data-scenario="httpObjects"><span
                                class="s-title">HTTP对象</span></button>
                        <button class="scenario-card" data-scenario="ftpData"><span
                                class="s-title">FTP数据</span></button>
                        <button class="scenario-card" data-scenario="smbFiles"><span
                                class="s-title">SMB文件</span></button>
                    </div>
                </div>

                <!-- 八、TLS/加密流量 -->
                <div class="scenario-category">
                    <h3 class="category-title">TLS/加密流量</h3>
                    <div class="scenarios-grid">
                        <button class="scenario-card" data-scenario="tlsHandshake"><span
                                class="s-title">TLS握手</span></button>
                        <button class="scenario-card" data-scenario="tlsSni"><span class="s-title">TLS
                                SNI</span></button>
                        <button class="scenario-card" data-scenario="sshTraffic"><span
                                class="s-title">SSH流量</span></button>
                    </div>
                </div>

                <!-- 九、加密Webshell检测 -->
                <div class="scenario-category">
                    <h3 class="category-title">加密Webshell检测</h3>
                    <div class="scenarios-grid">
                        <button class="scenario-card" data-scenario="behinder"><span
                                class="s-title">冰蝎检测</span></button>
                        <button class="scenario-card" data-scenario="godzilla"><span
                                class="s-title">哥斯拉检测</span></button>
                        <button class="scenario-card" data-scenario="antsword"><span
                                class="s-title">蚁剑检测</span></button>
                        <button class="scenario-card" data-scenario="shellPHP"><span
                                class="s-title">PHP一句话</span></button>
                        <button class="scenario-card" data-scenario="shellJSP"><span
                                class="s-title">JSP马检测</span></button>
                        <button class="scenario-card" data-scenario="shellASP"><span
                                class="s-title">ASP马检测</span></button>
                        <button class="scenario-card" data-scenario="cobaltstrike"><span
                                class="s-title">CobaltStrike</span></button>
                    </div>
                </div>
            </section>

            <!-- Tab: Filters -->
            <section id="tab-filters" class="tab-content">
                <div class="panel-header">
                    <h2>显示过滤器 (-Y)</h2>
                    <p>精确筛选你需要的数据包</p>
                </div>

                <div class="card-box">
                    <label class="section-label"
                        style="font-size: 13px; font-weight: 500; color: var(--text-secondary);">常用协议</label>
                    <div class="protocol-chips">
                        <button class="proto-chip" data-filter="http">HTTP</button>
                        <button class="proto-chip" data-filter="dns">DNS</button>
                        <button class="proto-chip" data-filter="ftp">FTP</button>
                        <button class="proto-chip" data-filter="smtp">SMTP</button>
                        <button class="proto-chip" data-filter="tcp">TCP</button>
                        <button class="proto-chip" data-filter="udp">UDP</button>
                        <button class="proto-chip" data-filter="icmp">ICMP</button>
                        <button class="proto-chip" data-filter="tls">TLS</button>
                        <button class="proto-chip" data-filter="ssh">SSH</button>
                    </div>

                    <div class="grid-2 mt-4">
                        <div class="form-group">
                            <label>源 IP</label>
                            <input type="text" id="srcIp" class="modern-input" placeholder="192.168.1.1">
                        </div>
                        <div class="form-group">
                            <label>目标 IP</label>
                            <input type="text" id="dstIp" class="modern-input" placeholder="10.0.0.1">
                        </div>
                        <div class="form-group">
                            <label>端口</label>
                            <input type="text" id="port" class="modern-input" placeholder="80, 443">
                        </div>
                        <div class="form-group">
                            <label>关键词</label>
                            <input type="text" id="containsKeyword" class="modern-input" placeholder="flag, password">
                        </div>
                    </div>

                    <div class="form-group mt-4">
                        <label>自定义过滤器</label>
                        <input type="text" id="customFilter" class="modern-input"
                            placeholder='http.request.method == "POST"'>
                    </div>

                    <div class="filter-logic mt-4" style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 13px; color: var(--text-secondary);">逻辑运算:</span>
                        <div class="logic-toggle" style="display: flex; gap: 12px;">
                            <label class="modern-checkbox">
                                <input type="radio" name="filterLogic" value="and" checked>
                                <span class="checkmark" style="border-radius: 50%;"></span>
                                AND
                            </label>
                            <label class="modern-checkbox">
                                <input type="radio" name="filterLogic" value="or">
                                <span class="checkmark" style="border-radius: 50%;"></span>
                                OR
                            </label>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab: Output -->
            <section id="tab-output" class="tab-content">
                <div class="panel-header">
                    <h2>输出格式</h2>
                    <p>定义数据的展示方式</p>
                </div>

                <div class="card-box">
                    <div class="format-selector"
                        style="display: flex; gap: 24px; border-bottom: 1px solid var(--border-color); padding-bottom: 16px;">
                        <label class="modern-checkbox">
                            <input type="radio" name="outputFormat" value="default" checked>
                            <span class="checkmark" style="border-radius: 50%;"></span>
                            默认
                        </label>
                        <label class="modern-checkbox">
                            <input type="radio" name="outputFormat" value="fields">
                            <span class="checkmark" style="border-radius: 50%;"></span>
                            字段 (-T fields)
                        </label>
                        <label class="modern-checkbox">
                            <input type="radio" name="outputFormat" value="json">
                            <span class="checkmark" style="border-radius: 50%;"></span>
                            JSON
                        </label>
                        <label class="modern-checkbox">
                            <input type="radio" name="outputFormat" value="pdml">
                            <span class="checkmark" style="border-radius: 50%;"></span>
                            XML
                        </label>
                    </div>

                    <div id="fieldsOptions" class="fields-area hidden mt-4">
                        <div class="fields-grid">
                            <div class="field-group">
                                <h4>通用</h4>
                                <label class="field-check"><input type="checkbox" value="frame.number"> 帧号</label>
                                <label class="field-check"><input type="checkbox" value="frame.time"> 时间</label>
                                <label class="field-check"><input type="checkbox" value="frame.len"> 长度</label>
                            </div>
                            <div class="field-group">
                                <h4>网络层</h4>
                                <label class="field-check"><input type="checkbox" value="ip.src"> 源IP</label>
                                <label class="field-check"><input type="checkbox" value="ip.dst"> 目标IP</label>
                                <label class="field-check"><input type="checkbox" value="ip.proto"> 协议号</label>
                            </div>
                            <div class="field-group">
                                <h4>传输层</h4>
                                <label class="field-check"><input type="checkbox" value="tcp.srcport"> TCP源端口</label>
                                <label class="field-check"><input type="checkbox" value="tcp.dstport"> TCP目标端口</label>
                                <label class="field-check"><input type="checkbox" value="udp.srcport"> UDP源端口</label>
                            </div>
                            <div class="field-group">
                                <h4>HTTP</h4>
                                <label class="field-check"><input type="checkbox" value="http.host"> Host</label>
                                <label class="field-check"><input type="checkbox" value="http.request.uri"> URI</label>
                                <label class="field-check"><input type="checkbox" value="http.request.method">
                                    Method</label>
                            </div>
                        </div>

                        <div class="form-group mt-4">
                            <label>自定义字段</label>
                            <input type="text" id="customField" class="modern-input" placeholder="输入字段名后回车">
                        </div>

                        <div class="grid-2 mt-4">
                            <div class="form-group">
                                <label>分隔符</label>
                                <select id="separator" class="modern-select">
                                    <option value=",">, (逗号)</option>
                                    <option value="\t">Tab</option>
                                    <option value="|">| (管道)</option>
                                    <option value=" ">空格</option>
                                </select>
                            </div>
                            <div class="checkbox-row align-center" style="align-items: center; display: flex;">
                                <label class="modern-checkbox">
                                    <input type="checkbox" id="includeHeader" checked>
                                    <span class="checkmark"></span>
                                    包含标题行
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="checkbox-row mt-4">
                        <label class="modern-checkbox">
                            <input type="checkbox" id="verbose">
                            <span class="checkmark"></span>
                            详细输出 (-V)
                        </label>
                        <label class="modern-checkbox">
                            <input type="checkbox" id="quiet">
                            <span class="checkmark"></span>
                            静默模式 (-q)
                        </label>
                        <label class="modern-checkbox">
                            <input type="checkbox" id="noResolve">
                            <span class="checkmark"></span>
                            禁用解析 (-n)
                        </label>
                    </div>
                </div>
            </section>

            <!-- Tab: Statistics -->
            <section id="tab-stats" class="tab-content">
                <div class="panel-header">
                    <h2>统计分析 (-z)</h2>
                    <p>生成各种统计报告</p>
                </div>

                <div class="card-box">
                    <div class="stats-grid">
                        <label class="stat-card">
                            <input type="checkbox" class="stat-option" value="io,phs">
                            <span class="stat-content">
                                <span class="stat-title">协议层级</span>
                                <span class="stat-desc">io,phs</span>
                            </span>
                        </label>
                        <label class="stat-card">
                            <input type="checkbox" class="stat-option" value="conv,ip">
                            <span class="stat-content">
                                <span class="stat-title">IP会话</span>
                                <span class="stat-desc">conv,ip</span>
                            </span>
                        </label>
                        <label class="stat-card">
                            <input type="checkbox" class="stat-option" value="http,tree">
                            <span class="stat-content">
                                <span class="stat-title">HTTP统计</span>
                                <span class="stat-desc">http,tree</span>
                            </span>
                        </label>
                        <label class="stat-card">
                            <input type="checkbox" class="stat-option" value="dns,tree">
                            <span class="stat-content">
                                <span class="stat-title">DNS统计</span>
                                <span class="stat-desc">dns,tree</span>
                            </span>
                        </label>
                        <label class="stat-card">
                            <input type="checkbox" class="stat-option" value="expert">
                            <span class="stat-content">
                                <span class="stat-title">专家信息</span>
                                <span class="stat-desc">expert</span>
                            </span>
                        </label>
                    </div>

                    <div class="form-group mt-4">
                        <label>追踪 TCP 流</label>
                        <input type="number" id="tcpStream" class="modern-input" placeholder="流ID (0,1,2...)">
                    </div>
                </div>
            </section>

            <!-- Tab: Advanced -->
            <section id="tab-advanced" class="tab-content">
                <div class="panel-header">
                    <h2>高级选项</h2>
                    <p>更多控制参数</p>
                </div>

                <div class="card-box">
                    <div class="checkbox-row">
                        <label class="modern-checkbox">
                            <input type="checkbox" id="twoPass">
                            <span class="checkmark"></span>
                            两遍分析 (-2)
                        </label>
                    </div>

                    <div class="grid-2 mt-4">
                        <div class="form-group">
                            <label>限制包数 (-c)</label>
                            <input type="number" id="packetCount" class="modern-input" placeholder="100">
                        </div>
                        <div class="form-group">
                            <label>输出文件 (-w)</label>
                            <input type="text" id="outputFile" class="modern-input" placeholder="output.pcap">
                        </div>
                    </div>

                    <div class="form-group mt-4">
                        <label>Decode As (-d)</label>
                        <input type="text" id="decodeAs" class="modern-input" placeholder="tcp.port==8080,http">
                    </div>
                </div>
            </section>

            <!-- Knowledge Base Tab -->
            <section id="tab-knowledge" class="tab-content">
                <div class="section-header">
                    <h2>📚 CTF流量分析知识库</h2>
                    <p>涵盖CTF和电子取证流量分析的完整题型分类与解题指南</p>
                </div>

                <div class="knowledge-search">
                    <input type="text" id="knowledgeSearch" class="modern-input" placeholder="搜索知识条目...">
                </div>

                <div class="knowledge-categories" id="knowledgeCategories">
                    <!-- 动态生成分类按钮 -->
                </div>

                <div class="knowledge-list" id="knowledgeList">
                    <!-- 动态生成知识条目 -->
                </div>

                <!-- 知识详情模态框 -->
                <div id="knowledgeDetail" class="knowledge-detail hidden">
                    <div class="detail-header">
                        <h3 id="detailTitle">条目标题</h3>
                        <button id="closeDetail" class="icon-btn">×</button>
                    </div>
                    <div class="detail-body">
                        <div class="detail-section">
                            <h4>📝 描述</h4>
                            <p id="detailDesc"></p>
                        </div>
                        <div class="detail-section">
                            <h4>🔍 TShark过滤器</h4>
                            <code id="detailFilter" class="filter-code"></code>
                        </div>
                        <div class="detail-section">
                            <h4>💡 解题技巧</h4>
                            <ul id="detailTips"></ul>
                        </div>
                        <div class="detail-section">
                            <h4>⌨️ 常用命令</h4>
                            <div id="detailCommands"></div>
                        </div>
                    </div>
                    <div class="detail-footer">
                        <button id="applyKnowledge" class="action-btn primary">应用此过滤器</button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Bottom Command Bar -->
        <footer class="command-bar">
            <div class="cmd-preview">
                <code id="commandOutput">tshark -r capture.pcap</code>
            </div>
            <div class="cmd-actions">
                <button id="copyCmd" class="action-btn primary">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                    复制
                </button>
                <button id="downloadScript" class="action-btn secondary">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    脚本
                </button>
                <button id="runCmd" class="action-btn run">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                    运行
                </button>
                <button id="resetAll" class="action-btn danger">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <polyline points="23 4 23 10 17 10"></polyline>
                        <polyline points="1 20 1 14 7 14"></polyline>
                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                    </svg>
                    重置
                </button>
            </div>
            <div id="copyToast" class="toast">✓ 已复制</div>
        </footer>
    </div>

    <!-- AI Modal -->
    <div id="aiModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-container glass-modal">
            <div class="modal-header">
                <h3>🤖 AI 流量分析助手</h3>
                <div class="modal-actions">
                    <button id="aiSettingsBtn" class="icon-btn" title="设置">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                            stroke-linejoin="round">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path
                                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                            </path>
                        </svg>
                    </button>
                    <button id="closeAiModal" class="icon-btn" title="关闭">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                            stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </div>

            <div id="aiSettings" class="ai-settings hidden">
                <div class="form-group">
                    <label>API Base URL</label>
                    <input type="text" id="apiBaseUrl" class="modern-input" placeholder="https://api.openai.com/v1">
                </div>
                <div class="form-group">
                    <label>API Key</label>
                    <input type="password" id="apiKey" class="modern-input" placeholder="sk-...">
                </div>
                <div class="form-group">
                    <label>模型</label>
                    <input type="text" id="apiModel" class="modern-input" placeholder="gpt-4" value="gpt-4">
                </div>
                <button id="saveApiSettings" class="action-btn primary full-width">保存设置</button>
            </div>

            <div class="chat-container">
                <div id="chatMessages" class="chat-messages">
                    <div class="chat-message assistant">
                        <div class="message-content">
                            👋 你好！我是你的 AI 助手。告诉我你想分析什么，我会帮你生成 tshark 命令。
                        </div>
                    </div>
                </div>
                <div class="chat-input-area">
                    <textarea id="chatInput" placeholder="例如：找出所有访问百度的HTTP请求..." rows="1"></textarea>
                    <button id="sendMessage" class="send-btn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                            stroke-linejoin="round">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                        </svg>
                        <span id="sendBtnLoading" class="hidden">⏳</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Run Result Modal -->
    <div id="resultModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-container result-modal">
            <div class="modal-header">
                <h3 id="resultTitle">执行结果</h3>
                <div class="modal-actions">
                    <button id="closeResultModal" class="icon-btn" title="关闭">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                            stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="result-content">
                <pre id="resultOutput">等待执行...</pre>
            </div>
            <div class="result-footer">
                <span id="resultStatus" class="status-badge">就绪</span>
                <button id="copyResult" class="action-btn secondary">复制结果</button>
            </div>
        </div>
    </div>

    <script src="knowledge.js"></script>
    <script src="modern.js"></script>
</body>

</html>